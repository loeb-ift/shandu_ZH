# Ohlala 系統查詢澄清過程

Ohlala 系統在初始查詢時會進行查詢澄清（query clarification）的過程，這是在實際研究開始之前向使用者提出問題的時間點。

在 `ohlala/cli.py` 中，我們可以看到系統在開始研究之前會調用 `clarify_query` 函數：`cli.py:357-361`。

這個 `clarify_query` 函數會向使用者提出問題以澄清和改進初始查詢。系統會在這個階段向使用者提出問題，而不是在研究過程中的其他時間點。

在 `ohlala/prompts.py` 中，我們可以看到用於生成澄清問題的提示模板：`prompts.py:127-134`。

這個提示明確指示系統生成 4-5 個針對性問題，以澄清使用者的研究目標、範圍和知識水平。這些問題會在研究開始前向使用者提出，以便系統能夠更好地理解使用者的需求。

在使用者回答這些澄清問題後，系統會使用 `refine_query` 提示來處理使用者的回答並改進原始查詢：`prompts.py:136-142`。

## 總結

總結來說，Ohlala 研究系統在以下時間點向使用者提出問題：

1. 在初始查詢提交後，但在實際研究開始前。
2. 通過 `clarify_query` 函數的調用過程中。
3. 使用 `clarify_query` 提示模板生成問題。

這個查詢澄清過程是一次性的，發生在研究開始前，而不是研究過程中的多個時間點。
