# logger.py 概述

`logger.py` 是 Shandu 系統的日誌記錄模組，它設置了系統的日誌記錄器，定義了日誌格式，並提供了多種日誌記錄函數。這個模組確保系統操作可以被適當地記錄和追踪，有助於調試和監控。 [logger.py:1-5](#)

## 主要功能

### 1. 日誌設置

`logger.py` 首先設置了基本的日誌配置，包括日誌目錄、文件名和格式：[logger.py:11-25](#)

這段代碼：
- 創建日誌目錄 (`~/.shandu/logs`)
- 設置日誌級別為 DEBUG
- 使用當前日期創建日誌文件名
- 定義日誌格式，包含時間戳、模組名、日誌級別、文件名和行號

### 2. 調用者文件名獲取

模組提供了 `get_caller_filename()` 函數，用於獲取調用日誌函數的文件名：[logger.py:27-40](#)

這個函數使用 Python 的 `inspect` 模組來檢查調用堆棧，並提取調用者的文件名。這使得日誌記錄可以包含調用者的上下文信息。

### 3. 錯誤日誌記錄

`log_error()` 函數用於記錄錯誤信息，包括錯誤消息、異常對象和上下文信息：[logger.py:42-58](#)

這個函數在 Shandu 系統的多個組件中被使用，例如在報告生成過程中。

### 4. 警告日誌記錄

`log_warning()` 函數用於記錄警告信息：[logger.py:60-73](#)

### 5. 信息日誌記錄

`log_info()` 函數用於記錄一般信息：[logger.py:75-88](#)

## 在系統中的使用

`logger.py` 在 Shandu 系統的多個組件中被廣泛使用，特別是在錯誤處理和調試過程中。例如：
- **初始化節點**: 在研究計劃生成過程中記錄錯誤 [initialize.py:125-128](#)
- **查詢生成節點**: 在查詢生成過程中記錄錯誤 [generate_queries.py:67-69](#)
- **搜索節點**: 在搜索過程中記錄信息和錯誤 [search.py:65](#)
- **網頁抓取器**: 在抓取過程中記錄信息和錯誤 [scraper.py:225](#)

## 日誌格式和存儲

日誌以文本文件形式存儲在用戶的主目錄下的 `.shandu/logs` 目錄中，文件名包含日期信息（例如 `shandu_2025-04-29.log`）。每條日誌記錄包含以下信息：
- 時間戳
- 模組名
- 日誌級別（DEBUG、INFO、WARNING、ERROR）
- 文件名和行號
- 日誌消息

例如：
